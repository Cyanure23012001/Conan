
        <html>
        <head>
        <script type="text/javascript" src="https://unpkg.com/vis-network@9.0.4/dist/vis-network.min.js"></script>
        <link href="https://unpkg.com/vis-network@9.0.4/dist/dist/vis-network.min.css" rel="stylesheet" type="text/css" />
        <style type="text/css">
            body {
                padding: 0;
                margin: 0;
                background: #fff;
            }
            .legend-btn.residues.disabled {
                background: #b4b4b4 !important;
                color: #555 !important;
            }
            .legend-btn.interactions.disabled {
                border-color: #b4b4b4 !important;
                color: #555 !important;
            }
        </style>
        </head>
        <body>
        <div id="mynetwork"></div>
        <div id="networklegend"></div>
        <script type="text/javascript">
            
        var ifp, legend, nodes, edges, legend_buttons;
        function drawGraph(_id, nodes, edges, options) {
            var container = document.getElementById(_id);
            nodes = new vis.DataSet(nodes);
            edges = new vis.DataSet(edges);
            var data = {nodes: nodes, edges: edges};
            var network = new vis.Network(container, data, options);
            network.on("stabilizationIterationsDone", function () {
                network.setOptions( { physics: false } );
            });
            return network;
        }
        nodes = [{"id": "GLN244.A", "label": "GLN244.A", "color": "#59bee3", "shape": "box", "borderWidth": 0, "physics": true, "mass": 2, "group": "protein", "residue_type": "Polar"}, {"id": "GLY195.A", "label": "GLY195.A", "color": "#59e382", "shape": "box", "borderWidth": 0, "physics": true, "mass": 2, "group": "protein", "residue_type": "Aliphatic"}, {"label": "F", "shape": "circle", "color": "white", "font": {"color": "lime"}, "id": 0, "x": -375.71103561999445, "y": -115.91049058408818, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "F", "shape": "circle", "color": "white", "font": {"color": "lime"}, "id": 1, "x": -284.7783682226292, "y": 41.58950941591232, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 2, "x": -284.77836822262844, "y": -115.9104905840875, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 3, "x": -330.2447019213116, "y": -89.66049058408781, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 4, "x": -239.3120345239454, "y": -89.66049058408744, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 5, "x": -330.2447019213117, "y": -37.16049058408793, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 6, "x": -239.31203452394553, "y": -37.16049058408737, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 7, "x": -284.7783682226288, "y": -10.910490584087809, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 8, "x": -284.7783682226281, "y": -168.41049058408765, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "O", "shape": "circle", "color": "white", "font": {"color": "red"}, "id": 9, "x": -273.86300445469516, "y": -219.7632396226123, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 10, "x": -319.32933815337805, "y": -246.0132396226126, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 11, "x": -358.34444149094134, "y": -210.88388278877284, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 12, "x": -336.99076772946256, "y": -162.92274626253607, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 13, "x": -409.69719052946607, "y": -221.7992465567055, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "O", "shape": "circle", "color": "white", "font": {"color": "red"}, "id": 14, "x": -425.9205827341506, "y": -271.7297136622012, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 15, "x": -390.79122590031045, "y": -310.74481699976434, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 16, "x": -407.0146181049952, "y": -360.67528410526, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 17, "x": -371.88526127115506, "y": -399.6903874428231, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 18, "x": -320.53251223263027, "y": -388.7750236748907, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 19, "x": -304.3091200279456, "y": -338.8445565693951, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 20, "x": -339.43847686178566, "y": -299.82945323183196, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "N", "shape": "circle", "color": "white", "font": {"color": "blue"}, "id": 21, "x": -285.4031553987902, "y": -427.7901270124538, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 22, "x": -234.05040636026536, "y": -416.8747632445215, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 23, "x": -198.92104952642538, "y": -455.8898665820847, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "N", "shape": "circle", "color": "white", "font": {"color": "blue"}, "id": 24, "x": -215.14444173111016, "y": -505.8203336875804, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 25, "x": -266.49719076963487, "y": -516.7356974555125, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 26, "x": -301.62654760347493, "y": -477.7205941179494, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 27, "x": -180.01508489726996, "y": -544.8354370251434, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 28, "x": -196.23847710195534, "y": -594.7659041306392, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 29, "x": -161.10912026811513, "y": -633.7810074682026, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 30, "x": -109.75637122959021, "y": -622.8656437002705, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 31, "x": -93.53297902490529, "y": -572.935176594775, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 32, "x": -128.66233585874528, "y": -533.9200732572118, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "N", "shape": "circle", "color": "white", "font": {"color": "blue"}, "id": 33, "x": -74.62701439575042, "y": -661.8807470378339, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 34, "x": -85.54237816368341, "y": -713.2334960763585, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "O", "shape": "circle", "color": "white", "font": {"color": "red"}, "id": 35, "x": -133.5035146899199, "y": -734.5871698378372, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "N", "shape": "circle", "color": "white", "font": {"color": "blue"}, "id": 36, "x": -40.07604446500051, "y": -739.4834960763586, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "N", "shape": "circle", "color": "white", "font": {"color": "blue"}, "id": 37, "x": -1.0609411274368252, "y": -704.354139242519, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 38, "x": -22.414614888915978, "y": -656.3930027162824, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 39, "x": -34.58830014344909, "y": -791.6958955831919, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 40, "x": -77.06169234813488, "y": -822.5546213285473, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 41, "x": -71.57394802658327, "y": -874.7670208353809, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 42, "x": 13.372836382787083, "y": -813.0495693446728, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 43, "x": 18.860580704336666, "y": -865.2619688515067, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "OH", "shape": "ellipse", "color": "white", "font": {"color": "red"}, "id": 44, "x": 55.84622858747296, "y": -782.1908435993198, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 46, "x": -232.56596871579396, "y": -162.92274626253462, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "N", "shape": "circle", "color": "white", "font": {"color": "blue"}, "id": 47, "x": -211.2122949543162, "y": -114.96160973629723, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "N", "shape": "circle", "color": "white", "font": {"color": "blue"}, "id": 48, "x": -159.85954591579204, "y": -104.04624596836224, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 49, "x": -154.3718015942426, "y": -51.83384646152768, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": "N", "shape": "circle", "color": "white", "font": {"color": "blue"}, "id": 50, "x": -202.33293812048004, "y": -30.480172700050268, "fixed": true, "group": "ligand", "borderWidth": 0}, {"label": " ", "shape": "dot", "color": "black", "size": 5.6000000000000005, "id": 51, "x": -237.46229495431828, "y": -69.49527603761526, "fixed": true, "group": "ligand", "borderWidth": 0}];
        edges = [{"from": 41, "to": "GLN244.A", "title": "VdWContact", "interaction_type": "VdWContact", "color": "#59e3ad", "smooth": {"type": "cubicBezier", "roundness": 0.2}, "dashes": [10], "width": 6.0, "group": "interaction"}, {"from": 0, "to": "GLY195.A", "title": "VdWContact", "interaction_type": "VdWContact", "color": "#59e3ad", "smooth": {"type": "cubicBezier", "roundness": 0.2}, "dashes": [10], "width": 6.0, "group": "interaction"}, {"from": 3, "to": 0, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 3, "to": 2, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 4, "to": 2, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 5, "to": 3, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 6, "to": 4, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 7, "to": 6, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 7, "to": 1, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 7, "to": 5, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 8, "to": 2, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 9, "to": 8, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 10, "to": 9, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 11, "to": 10, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 12, "to": 11, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 12, "to": 8, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 13, "to": 11, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 14, "to": 13, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 15, "to": 14, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 16, "to": 15, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 17, "to": 16, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 18, "to": 17, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 19, "to": 18, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 20, "to": 19, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 20, "to": 15, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 21, "to": 18, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 22, "to": 21, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 23, "to": 22, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 24, "to": 23, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 25, "to": 24, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 26, "to": 25, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 26, "to": 21, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 27, "to": 24, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 28, "to": 27, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 29, "to": 28, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 30, "to": 29, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 31, "to": 30, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 32, "to": 27, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 32, "to": 31, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 33, "to": 30, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 34, "to": 33, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 35, "to": 34, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 36, "to": 34, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 37, "to": 36, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 38, "to": 33, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 38, "to": 37, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 39, "to": 36, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 40, "to": 39, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 41, "to": 40, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 42, "to": 39, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 43, "to": 42, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 44, "to": 42, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 46, "to": 8, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 47, "to": 46, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 48, "to": 47, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 49, "to": 48, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 50, "to": 49, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 51, "to": 50, "color": "black", "physics": false, "group": "ligand", "width": 4}, {"from": 51, "to": 47, "color": "black", "physics": false, "group": "ligand", "width": 4}];
        ifp = drawGraph('mynetwork', nodes, edges, {"width": "100%", "height": "500px", "nodes": {"font": {"size": 20}}, "physics": {"barnesHut": {"avoidOverlap": 0.8, "springConstant": 0.1}}});
    
        legend_buttons = [{"index": 0, "label": "Aliphatic", "color": "#59e382", "group": "residues"}, {"index": 1, "label": "Polar", "color": "#59bee3", "group": "residues"}, {"index": 0, "label": "VdWContact", "color": "#59e3ad", "group": "interactions"}];
        legend = document.getElementById('networklegend');
        var div_residues = document.createElement('div');
        var div_interactions = document.createElement('div');
        var disabled = [];
        var legend_callback = function() {
            this.classList.toggle("disabled");
            var hide = this.classList.contains("disabled");
            var show = !hide;
            var btn_label = this.innerHTML;
            if (hide) {
                disabled.push(btn_label);
            } else {
                disabled = disabled.filter(x => x !== btn_label);
            }
            var node_update = [],
                edge_update = [];
            // click on residue type
            if (this.classList.contains("residues")) {
                nodes.forEach((node) => {
                    // find nodes corresponding to this type
                    if (node.residue_type === btn_label) {
                        // if hiding this type and residue isn't already hidden
                        if (hide && !node.hidden) {
                            node.hidden = true;
                            node_update.push(node);
                        // if showing this type and residue isn't already visible
                        } else if (show && node.hidden) {
                            // display if there's at least one of its edge that isn't hidden
                            num_edges_active = edges.filter(x => x.to === node.id)
                                                    .map(x => Boolean(x.hidden))
                                                    .filter(x => !x)
                                                    .length;
                            if (num_edges_active > 0) {
                                node.hidden = false;
                                node_update.push(node);
                            }
                        }
                    }
                });
                ifp.body.data.nodes.update(node_update);
            // click on interaction type
            } else {
                edges.forEach((edge) => {
                    // find edges corresponding to this type
                    if (edge.interaction_type === btn_label) {
                        edge.hidden = !edge.hidden;
                        edge_update.push(edge);
                        // number of active edges for the corresponding residue
                        var num_edges_active = edges.filter(x => x.to === edge.to)
                                               .map(x => Boolean(x.hidden))
                                               .filter(x => !x)
                                               .length;
                        // find corresponding residue
                        var ix = nodes.findIndex(x => x.id === edge.to);
                        // only change visibility if residue_type not being hidden
                        if (!(disabled.includes(nodes[ix].residue_type))) {
                            // hide if no edge being shown for this residue
                            if (hide && (num_edges_active === 0)) {
                                nodes[ix].hidden = true;
                                node_update.push(nodes[ix]);
                            // show if edges are being shown
                            } else if (show && (num_edges_active > 0)) {
                                nodes[ix].hidden = false;
                                node_update.push(nodes[ix]);
                            }
                        }
                    }
                });
                ifp.body.data.nodes.update(node_update);
                ifp.body.data.edges.update(edge_update);
            }
        };
        legend_buttons.forEach(function(v,i) {
            if (v.group === "residues") {
                var div = div_residues;
                var border = "none";
                var color = v.color;
            } else {
                var div = div_interactions;
                var border = "3px dashed " + v.color;
                var color = "white";
            }
            var button = div.appendChild(document.createElement('button'));
            button.classList.add("legend-btn", v.group);
            button.innerHTML = v.label;
            Object.assign(button.style, {
                "cursor": "pointer",
                "background-color": color,
                "border": border,
                "border-radius": "5px",
                "padding": "5px",
                "margin": "5px",
                "font": "14px 'Arial', sans-serif",
            });
            button.onclick = legend_callback;
        });
        legend.appendChild(div_residues);
        legend.appendChild(div_interactions);
        
        </script>
        </body>
        </html>
    